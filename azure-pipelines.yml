trigger:
  - master   # or "master" if that's your default branch

pool:
  name: Barenexus_Pool

steps:
  - checkout: self

  # Use Node.js 20
  - task: NodeTool@0
    inputs:
      versionSpec: '20.x'
    displayName: 'Use Node.js 20'

  # Install dependencies
  - script: |
      npm ci --legacy-peer-deps
    displayName: 'Install dependencies'
    workingDirectory: $(System.DefaultWorkingDirectory)

  # Build React app
  - script: |
      npm run build
    displayName: 'Build React app'
    workingDirectory: $(System.DefaultWorkingDirectory)

  # Deploy to Azure Static Web Apps
  - task: AzureStaticWebApp@0
    inputs:
      app_location: "/"            # root of your repo
      output_location: "build"     # CRA build output folder
      azure_static_web_apps_api_token: $(swa_token)
    displayName: 'Deploy to Azure Static Web App'
